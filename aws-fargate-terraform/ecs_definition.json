[
  {
    "logConfiguration": {
      "logDriver": "awslogs",
      "options": {
        "awslogs-group": "/ecs/eventuate",
        "awslogs-region": "${logs_region}",
        "awslogs-stream-prefix": "ecs"
      }
    },
    "portMappings": [
      {
        "hostPort": 2181,
        "protocol": "tcp",
        "containerPort": 2181
      },
      {
        "hostPort": 2888,
        "protocol": "tcp",
        "containerPort": 2888
      },
      {
        "hostPort": 3888,
        "protocol": "tcp",
        "containerPort": 3888
      }
    ],
    "cpu": 340,
    "environment": [],
    "memoryReservation": 512,
    "image": "eventuateio/eventuateio-local-zookeeper:0.18.0.RELEASE",
    "dependsOn": null,
    "name": "zookeeper"
  },
  {
    "logConfiguration": {
      "logDriver": "awslogs",
      "options": {
        "awslogs-group": "/ecs/eventuate",
        "awslogs-region": "${logs_region}",
        "awslogs-stream-prefix": "ecs"
      }
    },
    "portMappings": [
      {
        "hostPort": 9092,
        "protocol": "tcp",
        "containerPort": 9092
      }
    ],
    "cpu": 340,
    "environment": [
      {
        "name": "ADVERTISED_HOST_NAME",
        "value": "127.0.0.1"
      },
      {
        "name": "KAFKA_HEAP_OPTS",
        "value": "-Xmx320m -Xms320m"
      },
      {
        "name": "ZOOKEEPER_SERVERS",
        "value": "127.0.0.1:2181"
      }
    ],
    "memoryReservation": 512,
    "image": "eventuateio/eventuateio-local-kafka:0.18.0.RELEASE",
    "dependsOn": [
      {
        "containerName": "zookeeper",
        "condition": "START"
      }
    ],
    "name": "kafka"
  },
  {
    "logConfiguration": {
      "logDriver": "awslogs",
      "options": {
        "awslogs-group": "/ecs/eventuate",
        "awslogs-region": "${logs_region}",
        "awslogs-stream-prefix": "ecs"
      }
    },
    "portMappings": [
      {
        "hostPort": 8099,
        "protocol": "tcp",
        "containerPort": 8099
      },
      {
        "hostPort": 8088,
        "protocol": "tcp",
        "containerPort": 8088
      }
    ],
    "cpu": 340,
    "environment": [
      {
        "name": "EVENTUATELOCAL_CDC_MYSQL_BINLOG_CLIENT_UNIQUE_ID",
        "value": "1234567890"
      },
      {
        "name": "EVENTUATELOCAL_CDC_READ_OLD_DEBEZIUM_DB_OFFSET_STORAGE_TOPIC",
        "value": "false"
      },
      {
        "name": "EVENTUATELOCAL_CDC_READER_NAME",
        "value": "MySqlReader"
      },
      {
        "name": "EVENTUATELOCAL_CDC_OFFSET_STORE_KEY",
        "value": "MySqlBinlog"
      },
      {
        "name": "EVENTUATELOCAL_CDC_DB_PASSWORD",
        "value": "${db_pwd}"
      },
      {
        "name": "EVENTUATELOCAL_CDC_DB_USER_NAME",
        "value": "${db_user}"
      },
      {
        "name": "EVENTUATELOCAL_KAFKA_BOOTSTRAP_SERVERS",
        "value": "127.0.0.1:9092"
      },
      {
        "name": "EVENTUATELOCAL_ZOOKEEPER_CONNECTION_STRING",
        "value": "127.0.0.1:2181"
      },
      {
        "name": "SPRING_DATASOURCE_DRIVER_CLASS_NAME",
        "value": "com.mysql.jdbc.Driver"
      },
      {
        "name": "SPRING_DATASOURCE_PASSWORD",
        "value": "${db_pwd}"
      },
      {
        "name": "SPRING_DATASOURCE_URL",
        "value": "${db_url}"
      },
      {
        "name": "SPRING_DATASOURCE_USERNAME",
        "value": "${db_user}"
      }
    ],
    "memoryReservation": 1000,
    "image": "eventuateio/eventuate-cdc-service:0.4.0.RELEASE",
    "dependsOn": [
      {
        "containerName": "kafka",
        "condition": "START"
      }
    ],
    "name": "cdcservice",
    "healthCheck" : {
      "command" : [ "CMD-SHELL", "curl -f http://localhost:8080/actuator/health || exit 1" ],
      "startPeriod": 60
    }
  }
]
